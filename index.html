<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!--    Include the purecss.io CSS files for formatting and responsive design-->
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css"
          integrity="sha384-4ZPLezkTZTsojWFhpdFembdzFudphhoOzIunR1wH6g1WQDzCAiPvDyitaK67mp0+" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/base-min.css">
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-min.css">
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/grids-responsive-min.css">
    <!--    Make sure the width is equal to the device's native width-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="styles.css" rel="stylesheet" type="text/css"/>

    <!--    Get jQuery-->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>


    <title>Genghis Bot Battle System</title>
</head>
<body>
<!--Genghis Header-->
<div class="pure-g">
    <div class="pure-u-1-1">
        <div style="text-align: center;">
            <a class="silent" href="./index.html">
                <h1>Genghis</h1>
                <h4>Bot Battle System</h4>
            </a>
        </div>
    </div>
</div>
<!--Live now Card-->
<div class="pure-g">
    <div class="pure-u-1-1">
        <div class="shadow">
            <!--            Group for the left list-->
            <div class="pure-g">
                <div class="pure-u-1-1">
                    <h2>Games:</h2>
                    <ul id="games_list">
                        <li>No Games</li>
                    </ul>
                </div>
                <!--                Group for the RHS preview-->
                <!--
                <div class="pure-u-16-24" id="cpb_plot">
                    <svg xmlns="http://www.w3.org/2000/svg">
                        <rect width="100%" height="100%" fill="lightgrey"/>
                        <text x="20" y="30">Loading Game Preview...</text>
                    </svg>

                </div>
                -->
            </div>
        </div>
    </div>
</div>
<!--What's this Card-->
<div class="pure-g">
    <div class="pure-u-1-1">
        <div class="shadow">
            <h2>What is This?</h2>
            <p>Using the Genghis Battle System by
                <a href="https://github.com/beyarkay">Boyd Kane</a>,
                bots built by Computer Science students compete for
                resources, trade, and fight each other across
                multiple different battlegrounds.</p>
        </div>
    </div>
</div>
<!--Make a bot Card-->
<div class="pure-g">
    <div class="pure-u-1-1">
        <div class="shadow">
            <h2>Make your own bot</h2>
            <ol>
                <li>
                    So to start off, <a href="https://github.com/new">create 
                     new github repository</a>. In these instructions I'll assume
                    you've called it 'MY_GENGHIS_CLIENT_REPO', although the name doesn't matter.
                    Make sure to set it to private (so that nobody else can steal your code!). 
                    <br>There are some checkboxes at the bottom of the 'Create a 
                    new repository' page. Make sure to leave them UNTICKED and
                    then click 'Create repository'.
                </li>
                <li>
                    Then, on your machine, run the following lines in a linux/MacOS terminal, but
                    make sure you replace 'MY_GITHUB_USERNAME' and 'MY_GENGHIS_CLIENT_REPO' with 
                    your actual github username and your actual repository's name:
                        <code>
                        git clone --bare https://github.com/beyarkay/genghis_client.git <br>
                        cd genghis_client.git <br>
                        git push --mirror https://github.com/MY_GITHUB_USERNAME/MY_GENGHIS_CLIENT_REPO.git <br>
                        cd ..  <br>
                        rm -rf genghis_client.git <br>
                        git clone https://github.com/MY_GITHUB_USERNAME/MY_GENGHIS_CLIENT_REPO.git <br>
                        cd MY_GENGHIS_CLIENT_REPO <br>
                        git branch -M main <br>
                        git push -u origin main <br>
                        </code>
                    And now you're able to <a href="https://github.com/beyarkay/genghis_client/wiki/Building-Your-Bot">
                    start building your bot</a>. However, if you want to compete against other bots
                    on
                    <a href="https://people.cs.uct.ac.za/~KNXBOY001/genghis_server/index.html">
                    the genghis server</a>, you'll want to:
                </li>
            </ol>
            <h2>Register your bot with the Genghis Server</h2>
            1. go to your repository - settings - Deploy keys - add deploy key
            2. add in a title like 'Genghis Server Deploy Key
            3. Click <button onclick="keygen()">this button</button> to generate a
               key and copy it to your clipboard.
            4. Paste that key into the big text field and click 'Add key'
            3. click
            <ol>
                <li>
                    Click <button onclick="myFunction()">this button</button> and 
                </li>
                <li>All done! Your bot will be included in <a href="https://people.cs.uct.ac.za/~KNXBOY001/genghis_server/index.html">the next game</a>
                </li>
            </ol>
            <h2>Testing your bot on localhost</h2>
            <ol>
                <li>
                </li>
            </ol>
        </div>
    </div>
</div>

<script type="module">
    import {
    keygen
    } from './script.js';

    $.ajax({
        url: "server_state.json"
    }).done(data => {
        if (data && data['games']) {
            console.log("Data found: ", data['games']);
            // Update the list of games
            let ul = document.getElementById("games_list");
            ul.innerHTML = "";
            data['games'].sort((a, b) => a['game_dir'] > b['game_dir'] ? -1 : 1)
            for (let i = 0; i < data['games'].length; i++) {
                if (i > 10) {
                    let li = document.createElement("li");
                    // let a = document.createElement("a");
                    li.innerHTML = '...';
                    // li.appendChild(a);
                    ul.appendChild(li);
                    break;
                }
                let game = data['games'][i];
                let li = document.createElement("li");
                let a = document.createElement("a");
                a.setAttribute("href", "follow.html?game=" + game['game_dir'] + "&v=" + Date.now());
                a.innerHTML = "Game started on " + game['game_dir'].replace('games/', '').replace("T", " at ").replace(/:\d{2}\.\d{6}/, "" );
                a.style.color = i === 0 ? "#b30c0c" : "#a0a0a0";
                li.appendChild(a);
                ul.appendChild(li);
            }
            // draw_coins_per_bot('cpb_plot', selected_game_path);
        }
    });
</script>
</body>
</html>
